(()=>{"use strict";var e="",t={details:{image:null,imageBlob:null,title:null,summary:null,ingredients:null,directions:null,id:null},favoriteIcon:null,favoriteFunction:null,search:function(){window.location="#!/load";var i=document.querySelectorAll(".inputItem.recipeType.selected").length>=1?document.querySelectorAll(".inputItem.recipeType.selected")[0].attributes.data.value:"",o="";document.querySelectorAll(".inputItem.intolerance.selected").forEach((function(e,t){o+=t<=0?e.textContent:","+e.textContent}));var a=document.querySelectorAll("input")[0].checked?20:300;m.request({method:"GET",url:"https://api.spoonacular.com/recipes/complexSearch",params:{apiKey:"cdf510754c3541e8a42f14b7384540d1",instructionsRequired:!0,fillIngredients:!0,addRecipeInformation:!0,number:1,sort:"random",type:i,intolerances:o,maxReadyTime:a}}).then((function(e){var i=[];e.results[0].extendedIngredients.forEach((function(e,t){i.push(e.original)}));var o=[];e.results[0].analyzedInstructions[0].steps.forEach((function(e,t){o.push(e.step)})),t.details={title:e.results[0].title,summary:e.results[0].summary,ingredients:i,directions:o,id:e.results[0].id},fetch(e.results[0].image).then((function(e){return e.blob()})).then((function(e){t.details.imageBlob=e,t.details.image=URL.createObjectURL(e),n.showAsNotFavorited(),window.location="#!/recipe"}))})).catch((function(t){e=t,console.log(e),window.location="#!/error"}))},getRecipe:function(i){idb.openDB("favorites",1).then((function(e){return e.transaction(["recipes"],"readonly").objectStore("recipes").get(i)})).then((function(e){t.details=e,t.details.image=URL.createObjectURL(t.details.imageBlob),n.showAsFavorited(),window.location="#!/recipe"})).catch((function(t){e=t,console.log(e),window.location="#!/error"}))},saveRecipe:function(i){n.showAsLoading(),idb.openDB("favorites",1).then((function(e){var n=e.transaction(["recipes"],"readwrite"),i=n.objectStore("recipes"),o=t.details;return i.put(o),n.complete})).then((function(){setTimeout((function(){n.showAsFavorited(),m.redraw()}),1e3)})).catch((function(t){e=t,console.log(e),window.location="#!/error"}))},removeRecipe:function(i){n.showAsLoading(),idb.openDB("favorites",1).then((function(e){var n=e.transaction(["recipes"],"readwrite");return n.objectStore("recipes").delete(t.details.id),n.complete})).then((function(e){setTimeout((function(){n.showAsNotFavorited(),m.redraw()}),1e3)})).catch((function(t){e=t,console.log(e),window.location="#!/error"}))}},n={all:[],getAll:function(){idb.openDB("favorites",1).then((function(e){return e.transaction(["recipes"],"readonly").objectStore("recipes").getAll()})).then((function(e){e.length<=0?n.all=[]:n.all=e,o.open(),m.redraw()})).catch((function(e){n.all=[]}))},showAsFavorited:function(){t.favoriteIcon="../assets/favoritedIcon.png",t.favoriteFunction=t.removeRecipe},showAsNotFavorited:function(){t.favoriteIcon="../assets/notFavoritedIcon.png",t.favoriteFunction=t.saveRecipe},showAsLoading:function(){t.favoriteIcon="../assets/loading.gif",t.favoriteFunction=null}},i={intolerances:["Dairy","Egg","Gluten","Grain","Peanut","Seafood"],types:[{text:"Main",value:"main course"},{text:"Side Dish",value:"side dish"},{text:"Appetizer",value:"appetizer"},{text:"Soup",value:"soup"},{text:"Dessert",value:"dessert"},{text:"Snack",value:"snack"}],onIntoleranceClick:function(e){e.target.classList.toggle("selected")},onTypesClick:function(e){document.querySelectorAll(".inputItem.recipeType").forEach((function(e,t){e.classList.remove("selected")})),e.target.classList.add("selected")},onBackBtnClick:function(){URL.revokeObjectURL(t.details.image),window.location="#!/main"}},o={close:function(){document.getElementsByClassName("lightbox")[0].classList.add("slideOut"),document.getElementsByClassName("lightbox")[0].classList.remove("slideIn"),document.getElementsByClassName("lightboxBackground")[0].classList.add("hidden")},open:function(){document.getElementsByClassName("lightbox")[0].classList.remove("slideOut"),document.getElementsByClassName("lightbox")[0].classList.add("slideIn"),document.getElementsByClassName("lightboxBackground")[0].classList.remove("hidden")}};function a(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.element=t,this.swipes=n,this.initialX=null,this.initialY=null,this.attachEventHandlers()}var t,n;return t=e,(n=[{key:"attachEventHandlers",value:function(){var e=this;this.element.addEventListener("touchstart",(function(t){return e.startTouch(t)})),this.element.addEventListener("touchmove",(function(t){return e.moveTouch(t,e.swipes)}))}},{key:"startTouch",value:function(e){this.initialX=e.touches[0].clientX,this.initialY=e.touches[0].clientY}},{key:"moveTouch",value:function(e,t){if(null!==this.initialX&&null!==this.initialY){var n=e.touches[0].clientX,i=e.touches[0].clientY,o=this.initialX-n,a=this.initialY-i;Math.abs(o)>Math.abs(a)?o>0&&t.left?t.left():t.right&&t.right():a>0&&t.up?t.up():t.down&&t.down(),this.initialX=null,this.initialY=null,e.preventDefault()}}}])&&a(t.prototype,n),e}(),r={oncreate:function(){var e={left:o.close};new c(document.getElementsByClassName("lightbox")[0],e)},view:function(){return m(".header",[m(".lightbox",[m(".lightboxHeader","Saved Recipes"),n.all.map((function(e){return m(".savedRecipe",{onclick:function(){t.getRecipe(e.id)}},[m(".savedRecipeTitle",e.title),m("img.forwardImage",{src:"../assets/forward.png"})])}))]),m(".lightboxBackground.hidden",{onclick:o.close}),m("img.savedNavIcon",{src:"../assets/savedNavIcon.png",onclick:n.getAll}),m(".centerText","Recipe App")])}},l={view:function(){return m(".header",[m("img.backBtn",{alt:"navigate back",src:"../assets/back.png",onclick:i.onBackBtnClick}),m(".centerText","Recipe App")])}},s={view:function(){return m("offlineScreen.contentView",[m(r),m(".pageContent",[m(".pageSection",[m(".sectionHeader","You are offline. Saved recipes can be viewed but new ones cannot be found until you connect to the internet.")])])])}},u={view:function(){return m("recipeScreen.contentView",[m(l),m(".pageContent",[m(".heroSection",[m("img.heroImage.fadeIn",{src:t.details.image,alt:"image"})]),m(".pageSection.favoriteSection.fadeIn",[m(".favoriteTitle",t.details.title),m("img.favoriteImage",{src:t.favoriteIcon,onclick:t.favoriteFunction})]),m(".pageSection.fadeIn",[m(".listTitle","Ingredients"),m(".ingredientList",t.details.ingredients.map((function(e){return m(".ingredient",e)})))]),m(".pageSection.fadeIn",[m(".listTitle","Cooking directions"),m(".directionList",t.details.directions.map((function(e){return m(".direction",e)})))])])])}},d={oncreate:function(){history.replaceState(null,"home","#!/home")},view:function(){return m("loadingScreen.contentView",[m(".pageContent",[m("img.loadingImage",{src:"../assets/loading.gif"})])])}},f={oncreate:function(){history.replaceState(null,"home","#!/home")},view:function(){return m("errorScreen.contentView",[m(l),m(".pageContent",[m(".errorScreenText",e)])])}};window.onload=function(){window.location="#!/offline";var e=document.body.children[0];m.route(e,"/offline",{"/offline":s,"/load":d,"/error":f,"/recipe":u})}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZWNpcGVfYXBwLy4vc3JjL2RhdGEuanMiLCJ3ZWJwYWNrOi8vcmVjaXBlX2FwcC8uL3NyYy9zd2lwZS5qcyIsIndlYnBhY2s6Ly9yZWNpcGVfYXBwLy4vc3JjL3ZpZXdzLmpzIiwid2VicGFjazovL3JlY2lwZV9hcHAvLi9zcmMvb2ZmbGluZVNjcmlwdC5qcyJdLCJuYW1lcyI6WyJlcnJvclRocm93biIsInJlY2lwZSIsImRldGFpbHMiLCJpbWFnZSIsImltYWdlQmxvYiIsInRpdGxlIiwic3VtbWFyeSIsImluZ3JlZGllbnRzIiwiZGlyZWN0aW9ucyIsImlkIiwiZmF2b3JpdGVJY29uIiwiZmF2b3JpdGVGdW5jdGlvbiIsInNlYXJjaCIsIndpbmRvdyIsImxvY2F0aW9uIiwicmVjaXBlVHlwZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImxlbmd0aCIsImF0dHJpYnV0ZXMiLCJkYXRhIiwidmFsdWUiLCJpbnRvbGVyYW5jZXMiLCJmb3JFYWNoIiwiaXRlbSIsImkiLCJ0ZXh0Q29udGVudCIsIm1heFRpbWUiLCJjaGVja2VkIiwibSIsInJlcXVlc3QiLCJtZXRob2QiLCJ1cmwiLCJwYXJhbXMiLCJhcGlLZXkiLCJpbnN0cnVjdGlvbnNSZXF1aXJlZCIsImZpbGxJbmdyZWRpZW50cyIsImFkZFJlY2lwZUluZm9ybWF0aW9uIiwibnVtYmVyIiwic29ydCIsInR5cGUiLCJtYXhSZWFkeVRpbWUiLCJ0aGVuIiwicmVzdWx0IiwicmVzdWx0cyIsImV4dGVuZGVkSW5ncmVkaWVudHMiLCJwdXNoIiwib3JpZ2luYWwiLCJhbmFseXplZEluc3RydWN0aW9ucyIsInN0ZXBzIiwic3RlcCIsImZldGNoIiwicmVzcG9uc2UiLCJibG9iIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiZmF2b3JpdGVzIiwic2hvd0FzTm90RmF2b3JpdGVkIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZ2V0UmVjaXBlIiwiaWRiIiwib3BlbkRCIiwiZGIiLCJ0cmFuc2FjdGlvbiIsIm9iamVjdFN0b3JlIiwiZ2V0Iiwic2hvd0FzRmF2b3JpdGVkIiwic2F2ZVJlY2lwZSIsInNob3dBc0xvYWRpbmciLCJ0eCIsInN0b3JlIiwibmV3SXRlbSIsInB1dCIsImNvbXBsZXRlIiwic2V0VGltZW91dCIsInJlZHJhdyIsInJlbW92ZVJlY2lwZSIsIngiLCJhbGwiLCJnZXRBbGwiLCJpdGVtcyIsImxpZ2h0Ym94Iiwib3BlbiIsImUiLCJ1c2VySW5wdXRzIiwidHlwZXMiLCJ0ZXh0Iiwib25JbnRvbGVyYW5jZUNsaWNrIiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwib25UeXBlc0NsaWNrIiwicmVtb3ZlIiwiYWRkIiwib25CYWNrQnRuQ2xpY2siLCJyZXZva2VPYmplY3RVUkwiLCJjbG9zZSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJTd2lwZXIiLCJlbGVtZW50Iiwic3dpcGVzIiwidGhpcyIsImluaXRpYWxYIiwiaW5pdGlhbFkiLCJhdHRhY2hFdmVudEhhbmRsZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwic3RhcnRUb3VjaCIsIm1vdmVUb3VjaCIsInRvdWNoZXMiLCJjbGllbnRYIiwiY2xpZW50WSIsImN1cnJlbnRYIiwiY3VycmVudFkiLCJkaWZmWCIsImRpZmZZIiwiTWF0aCIsImFicyIsImxlZnQiLCJyaWdodCIsInVwIiwiZG93biIsInByZXZlbnREZWZhdWx0IiwiaGVhZGVyIiwib25jcmVhdGUiLCJ2aWV3IiwibWFwIiwib25jbGljayIsInNyYyIsImhlYWRlckJhY2tCdG4iLCJhbHQiLCJvZmZsaW5lU2NyZWVuIiwicmVjaXBlU2NyZWVuIiwibG9hZFNjcmVlbiIsImhpc3RvcnkiLCJyZXBsYWNlU3RhdGUiLCJlcnJvclNjcmVlbiIsIm9ubG9hZCIsInJvb3QiLCJib2R5IiwiY2hpbGRyZW4iLCJyb3V0ZSJdLCJtYXBwaW5ncyI6Im1CQUVBLElBQUlBLEVBQWMsR0FFZEMsRUFBUyxDQUNYQyxRQUFRLENBQ05DLE1BQU8s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QlEsRUFBYyxDQUNoQlosU0FBVSxXQUNSVSxRQUFRQyxhQUFhLEtBQU0sT0FBUSxZQUVyQ1YsS0FBTSxXQUNKLE9BQU9sRyxFQUFFLDBCQUEwQixDQUNqQ0EsRUFBRXNHLEdBQ0Z0RyxFQUFFLGVBQWUsQ0FDZkEsRUFBRSxtQkFBbUI3QixTQ3BJN0JhLE9BQU84SCxPQUFTLFdBSWQ5SCxPQUFPQyxTQUFXLGFBRWxCLElBQUk4SCxFQUFPNUgsU0FBUzZILEtBQUtDLFNBQVMsR0FHbENqSCxFQUFFa0gsTUFBTUgsRUFBTSxXQUFXLENBQ3ZCLFdBQVlQLEVBQ1osUUFBU0UsRUFDVCxTQUFVRyxFQUNWLFVBQVdKLE0iLCJmaWxlIjoib2ZmbGluZS1idW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKioqKioqKioqKkRhdGEgZm9yIHJlbmRlcmluZyBhcHAgdmlld3MqKioqKioqKioqKiovXHJcbi8vZXJyb3Igc2NyZWVuIHRleHRcclxudmFyIGVycm9yVGhyb3duID0gXCJcIjtcclxuLy9yZWNpcGUgcmVsYXRlZCBmdW5jdGlvbnMgYW5kIGRhdGFcclxudmFyIHJlY2lwZSA9IHtcclxuICBkZXRhaWxzOnsvL3RoZSBkZXRhaWxzIG9mIHRoZSByZWNpcGUgcmV0dXJuZWQgYnkgdGhlIGFwaVxyXG4gICAgaW1hZ2U6IG51bGwsXHJcbiAgICBpbWFnZUJsb2I6IG51bGwsXHJcbiAgICB0aXRsZTogbnVsbCxcclxuICAgIHN1bW1hcnk6IG51bGwsXHJcbiAgICBpbmdyZWRpZW50czogbnVsbCxcclxuICAgIGRpcmVjdGlvbnM6IG51bGwsXHJcbiAgICBpZDogbnVsbFxyXG4gIH0sXHJcbiAgZmF2b3JpdGVJY29uOiBudWxsLC8vdGhlIGltYWdlIHVzZWQgZm9yIHRoZSBmYXZvcml0ZSByZWNpcGUgaWNvblxyXG4gIGZhdm9yaXRlRnVuY3Rpb246IG51bGwsLy90aGUgZnVuY3Rpb24gY2FsbGVkIHdoZW4gdGhlIGZhdm9yaXRlIGljb24gaXMgY2xpY2tlZFxyXG4gIHNlYXJjaDogZnVuY3Rpb24oKSB7Ly91c2VzIHRoZSBhcGkgdG8gc2VyYWNoIGFuZCByZXR1cm4gYSByYW5kb20gcmVjaXBlXHJcbiAgICB3aW5kb3cubG9jYXRpb24gPSBcIiMhL2xvYWRcIjsvL3Nob3cgdGhlIGxvYWQgc2NyZWVuIHdoaWxlIHdhaXRpbmcgZm9yIHRoZSBhcGkgcmVzdWx0XHJcbiAgICAvL2dldCB0aGUgc2VsZWN0ZWQgcmVjaXBlIHR5cGVcclxuICAgIC8vaWYgbm9uZSBhcmUgc2VsZWN0ZWQgbGVhdmUgaXQgYmxhbmtcclxuICAgIHZhciByZWNpcGVUeXBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5pbnB1dEl0ZW0ucmVjaXBlVHlwZS5zZWxlY3RlZFwiKS5sZW5ndGggPj0gMSA/IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuaW5wdXRJdGVtLnJlY2lwZVR5cGUuc2VsZWN0ZWRcIilbMF0uYXR0cmlidXRlcy5kYXRhLnZhbHVlIDogXCJcIjtcclxuICAgIC8vZ2V0IHRoZSBzZWxlY3RlZCBpbnRvbGVyYW5jZXNcclxuICAgIHZhciBpbnRvbGVyYW5jZXMgPSBcIlwiO1xyXG4gICAgdmFyIHNlbGVjdGVkSW50b2xlcmFuY2VzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5pbnB1dEl0ZW0uaW50b2xlcmFuY2Uuc2VsZWN0ZWRcIik7XHJcbiAgICBzZWxlY3RlZEludG9sZXJhbmNlcy5mb3JFYWNoKChpdGVtLCBpKSA9PiB7XHJcbiAgICAgIGlmKGkgPD0gMCl7aW50b2xlcmFuY2VzICs9IGl0ZW0udGV4dENvbnRlbnR9Ly9hZGQgdGhlIGZpcnN0IGludG9sZXJhbmNlIHdpdGhvdXQgYSBjb21tYVxyXG4gICAgICBlbHNle2ludG9sZXJhbmNlcyArPSBcIixcIitpdGVtLnRleHRDb250ZW50fVxyXG4gICAgfSk7XHJcbiAgICAvL2dldCB0aGUgMzAgbWluIGFuZCB1bmRlciBjaGVja2JveFxyXG4gICAgdmFyIG1heFRpbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIilbMF0uY2hlY2tlZCA/IDIwIDogMzAwO1xyXG5cclxuICAgIG0ucmVxdWVzdCh7Ly9hcGkgY2FsbFxyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIHVybDogXCJodHRwczovL2FwaS5zcG9vbmFjdWxhci5jb20vcmVjaXBlcy9jb21wbGV4U2VhcmNoXCIsXHJcbiAgICAgIHBhcmFtczoge1xyXG4gICAgICAgIGFwaUtleTpcImNkZjUxMDc1NGMzNTQxZThhNDJmMTRiNzM4NDU0MGQxXCIsXHJcbiAgICAgICAgaW5zdHJ1Y3Rpb25zUmVxdWlyZWQ6dHJ1ZSxcclxuICAgICAgICBmaWxsSW5ncmVkaWVudHM6dHJ1ZSxcclxuICAgICAgICBhZGRSZWNpcGVJbmZvcm1hdGlvbjp0cnVlLFxyXG4gICAgICAgIG51bWJlcjoxLFxyXG4gICAgICAgIHNvcnQ6XCJyYW5kb21cIixcclxuICAgICAgICB0eXBlOiByZWNpcGVUeXBlLFxyXG4gICAgICAgIGludG9sZXJhbmNlczppbnRvbGVyYW5jZXMsXHJcbiAgICAgICAgbWF4UmVhZHlUaW1lOiBtYXhUaW1lXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbigocmVzdWx0KSA9PntcclxuICAgICAgLy9wYXJzZSB0aGUgaW5ncmVkaWVudHNcclxuICAgICAgdmFyIGluZ3JlZGllbnRzID0gW107XHJcbiAgICAgIHJlc3VsdC5yZXN1bHRzWzBdLmV4dGVuZGVkSW5ncmVkaWVudHMuZm9yRWFjaCgoaXRlbSwgaSkgPT4ge1xyXG4gICAgICAgIGluZ3JlZGllbnRzLnB1c2goaXRlbS5vcmlnaW5hbCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICAvL3BhcnNlIHRoZSBkaXJlY3Rpb25zXHJcbiAgICAgIHZhciBkaXJlY3Rpb25zID0gW107XHJcbiAgICAgIHJlc3VsdC5yZXN1bHRzWzBdLmFuYWx5emVkSW5zdHJ1Y3Rpb25zWzBdLnN0ZXBzLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcclxuICAgICAgICBkaXJlY3Rpb25zLnB1c2goaXRlbS5zdGVwKTtcclxuICAgICAgfSk7XHJcbiAgICAgIC8vZmlsbCBvdXQgdGhlIGRldGFpbHMgb2JqZWN0IHdpdGggdGhlIHJldHVybmVkIGRhdGFcclxuICAgICAgcmVjaXBlLmRldGFpbHMgPSB7XHJcbiAgICAgICAgdGl0bGU6IHJlc3VsdC5yZXN1bHRzWzBdLnRpdGxlLFxyXG4gICAgICAgIHN1bW1hcnk6IHJlc3VsdC5yZXN1bHRzWzBdLnN1bW1hcnksXHJcbiAgICAgICAgaW5ncmVkaWVudHM6IGluZ3JlZGllbnRzLFxyXG4gICAgICAgIGRpcmVjdGlvbnM6IGRpcmVjdGlvbnMsXHJcbiAgICAgICAgaWQ6IHJlc3VsdC5yZXN1bHRzWzBdLmlkXHJcbiAgICAgIH07XHJcbiAgICAgIC8vZ2V0IHRoZSBpbWFnZSBmcm9tIHRoZSB1cmwgYW5kIHJldHVybiBpdCBhcyBhIGJsb2JcclxuICAgICAgZmV0Y2gocmVzdWx0LnJlc3VsdHNbMF0uaW1hZ2UpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgIHJldHVybiByZXNwb25zZS5ibG9iKClcclxuICAgICAgICB9KVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGJsb2IpIHtcclxuICAgICAgICAgIHJlY2lwZS5kZXRhaWxzLmltYWdlQmxvYiA9IGJsb2I7XHJcbiAgICAgICAgICAvL2NvbnZlcnQgYmxvZyB0byB1cmxcclxuICAgICAgICAgIHJlY2lwZS5kZXRhaWxzLmltYWdlID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTtcclxuXHJcbiAgICAgICAgICAvL3NpbmNlIHRoaXMgaXMgYSBuZXcgc2VhcmNoIHRoZSBmYXZvcml0ZSBidXR0b24gc2hvdWxkIGJlIHNldCB0byB0aGUgIG5vdCBmYXZvcml0ZWQgb3B0aW9uXHJcbiAgICAgICAgICBmYXZvcml0ZXMuc2hvd0FzTm90RmF2b3JpdGVkKCk7XHJcblxyXG4gICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gXCIjIS9yZWNpcGVcIjsvL3VwZGF0ZSB0aGUgdXJsIHRvIHNob3cgdGhlIGZvb2Qgc2NyZWVuXHJcbiAgICAgICAgfSk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnJvcikgPT57Ly9zaG93IHRoZSBlcnJvclxyXG4gICAgICBlcnJvclRocm93biA9IGVycm9yO1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvclRocm93bik7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiIyEvZXJyb3JcIjtcclxuICAgIH0pXHJcbiAgfSxcclxuICBnZXRSZWNpcGU6IGZ1bmN0aW9uKGlkKXsvL2dldHMgdGhlIHNwZWNpZmllZCByZWNpcGUgZnJvbSB0aGUgZGF0YWJhc2VcclxuICAgIGlkYi5vcGVuREIoJ2Zhdm9yaXRlcycsIDEpLnRoZW4oKGRiKSA9PntcclxuICAgICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oWydyZWNpcGVzJ10sICdyZWFkb25seScpO1xyXG4gICAgICB2YXIgc3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVjaXBlcycpO1xyXG4gICAgICByZXR1cm4gc3RvcmUuZ2V0KGlkKTtcclxuICAgIH0pLnRoZW4oKGl0ZW0pID0+e1xyXG4gICAgICByZWNpcGUuZGV0YWlscyA9IGl0ZW07Ly9zZXQgdGhlIHJlY2lwZSBkZXRhaWxzIHRvIGJlIHRoZSBzYXZlZCByZWNpcGUgZGV0YWlsc1xyXG4gICAgICByZWNpcGUuZGV0YWlscy5pbWFnZSA9IFVSTC5jcmVhdGVPYmplY3RVUkwocmVjaXBlLmRldGFpbHMuaW1hZ2VCbG9iKTtcclxuICAgICAgLy90aGUgZmF2b3JpdGUgYnV0dG9uIHNob3VsZCBzaG93IGFzIGZhdm9yaXRlZFxyXG4gICAgICBmYXZvcml0ZXMuc2hvd0FzRmF2b3JpdGVkKCk7XHJcblxyXG4gICAgICB3aW5kb3cubG9jYXRpb24gPSBcIiMhL3JlY2lwZVwiOy8vbmF2aWdhdGUgdG8gdGhlIHJlY2lwZSBzY3JlZW4gdG8gc2hvdyB0aGUgcmVjaXBlXHJcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+e1xyXG4gICAgICBlcnJvclRocm93biA9IGVycm9yO1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvclRocm93bik7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiIyEvZXJyb3JcIjtcclxuICAgIH0pXHJcbiAgfSxcclxuICBzYXZlUmVjaXBlOiBmdW5jdGlvbihpZCl7Ly9hZGRzIHRoZSBjdXJyZW50IHJlY2lwZSB0byB0aGUgZmF2b3JpdGVzIGRhdGFiYXNlXHJcbiAgICBmYXZvcml0ZXMuc2hvd0FzTG9hZGluZygpOy8vc2hvdyB0aGUgbG9hZGluZyBnaWZcclxuICAgIGlkYi5vcGVuREIoJ2Zhdm9yaXRlcycsIDEpLnRoZW4oKGRiKSA9PntcclxuICAgICAgdmFyIHR4ID0gZGIudHJhbnNhY3Rpb24oWydyZWNpcGVzJ10sICdyZWFkd3JpdGUnKTtcclxuICAgICAgdmFyIHN0b3JlID0gdHgub2JqZWN0U3RvcmUoJ3JlY2lwZXMnKTtcclxuICAgICAgdmFyIG5ld0l0ZW0gPSByZWNpcGUuZGV0YWlscztcclxuICAgICAgc3RvcmUucHV0KG5ld0l0ZW0pO1xyXG4gICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICB9KS50aGVuKCgpID0+e1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+ey8vbWFrZSBzdXJlIHRvIHdhaXQgYXQgbGVhc3QgMSBzZWNvbmQgYmVmb3JlIHNob3dpbmcgdGhlIG5ldyBidXR0b25cclxuICAgICAgICAvL2ZhdnJvaXRlIGJ1dHRvbiBzaG91bGQgbm93IHNob3cgYXMgZmF2b3JpdGVkXHJcbiAgICAgICAgZmF2b3JpdGVzLnNob3dBc0Zhdm9yaXRlZCgpO1xyXG4gICAgICAgIG0ucmVkcmF3KCk7Ly92aWV3IG5lZWRzIHRvIGJlIHJlZHJhd25cclxuICAgICAgfSwgMTAwMCk7XHJcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+e1xyXG4gICAgICBlcnJvclRocm93biA9IGVycm9yO1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvclRocm93bik7XHJcbiAgICAgIHdpbmRvdy5sb2NhdGlvbiA9IFwiIyEvZXJyb3JcIjtcclxuICAgIH0pXHJcbiAgfSxcclxuICByZW1vdmVSZWNpcGU6IGZ1bmN0aW9uKGlkKXsvL2RlbGV0ZXMgdGhlIGN1cnJlbnQgcmVjaXBlIGZyb20gdGhlIGZhdm9yaXRlcyBkYXRhYmFzZVxyXG4gICAgZmF2b3JpdGVzLnNob3dBc0xvYWRpbmcoKTsvL3Nob3cgdGhlIGxvYWRpbmcgZ2lmIG9uIGJ1dHRvbiBjbGlja1xyXG4gICAgaWRiLm9wZW5EQignZmF2b3JpdGVzJywgMSkudGhlbigoZGIpID0+e1xyXG4gICAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbihbJ3JlY2lwZXMnXSwgJ3JlYWR3cml0ZScpO1xyXG4gICAgICB2YXIgc3RvcmUgPSB0eC5vYmplY3RTdG9yZSgncmVjaXBlcycpO1xyXG4gICAgICBzdG9yZS5kZWxldGUocmVjaXBlLmRldGFpbHMuaWQpO1xyXG4gICAgICByZXR1cm4gdHguY29tcGxldGU7XHJcbiAgICB9KS50aGVuKCh4KSA9PntcclxuICAgICAgc2V0VGltZW91dCgoKSA9PnsvL21ha2Ugc3VyZSB0byB3YWl0IGF0IGxlYXN0IDEgc2Vjb25kIGJlZm9yZSBzaG93aW5nIHRoZSBuZXcgYnV0dG9uXHJcbiAgICAgICAgLy9mYXZvcml0ZSBidXR0b24gc2hvdWxkIG5vdyBzaG93IGFzIG5vdCBmYXZvcml0ZWRcclxuICAgICAgICBmYXZvcml0ZXMuc2hvd0FzTm90RmF2b3JpdGVkKCk7XHJcbiAgICAgICAgbS5yZWRyYXcoKTsvL3ZpZXcgbmVlZHMgdG8gYmUgcmVkcmF3blxyXG4gICAgICB9LCAxMDAwKTtcclxuICAgIH0pLmNhdGNoKChlcnJvcikgPT57XHJcbiAgICAgIGVycm9yVGhyb3duID0gZXJyb3I7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yVGhyb3duKTtcclxuICAgICAgd2luZG93LmxvY2F0aW9uID0gXCIjIS9lcnJvclwiO1xyXG4gICAgfSlcclxuICB9LFxyXG59XHJcblxyXG4vL2Zhdm9yaXRlZCByZWNpcGUgZnVuY3Rpb25zIGFuZCBkYXRhXHJcbnZhciBmYXZvcml0ZXMgPSB7XHJcbiAgYWxsOiBbXSwvL2FycmF5IG9mIGFsbCBmYXZvcml0ZWQgcmVjaXBlc1xyXG4gIGdldEFsbDogZnVuY3Rpb24oKXsvL2dldHMgYWxsIHJlY2lwZXMgaW4gdGhlIGZhdm9yaXRlcyBkYXRhYmFzZVxyXG4gICAgaWRiLm9wZW5EQignZmF2b3JpdGVzJywgMSkudGhlbigoZGIpID0+e1xyXG4gICAgICB2YXIgdHggPSBkYi50cmFuc2FjdGlvbihbJ3JlY2lwZXMnXSwgJ3JlYWRvbmx5Jyk7XHJcbiAgICAgIHZhciBzdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZWNpcGVzJyk7XHJcbiAgICAgIHJldHVybiBzdG9yZS5nZXRBbGwoKTtcclxuICAgIH0pLnRoZW4oKGl0ZW1zKSA9PntcclxuICAgICAgaWYoaXRlbXMubGVuZ3RoIDw9IDApey8vaWYgdGhlcmUgaXMgbm8gcmVzdWx0c1xyXG4gICAgICAgIGZhdm9yaXRlcy5hbGwgPSBbXTtcclxuICAgICAgfVxyXG4gICAgICBlbHNle1xyXG4gICAgICAgIGZhdm9yaXRlcy5hbGwgPSBpdGVtczsvL3JldHVybiB0aGUgYXJyYXkgb2YgaXRlbXMgZnJvbSB0aGUgZGJcclxuICAgICAgfVxyXG4gICAgICBsaWdodGJveC5vcGVuKCk7XHJcbiAgICAgIG0ucmVkcmF3KCk7Ly9yZWRyYXcgdGhlIHZpZXdcclxuICAgIH0pLmNhdGNoKChlKSA9PnsvL3RoZXJlIHdhcyBhbiBlcnJvciByZWFkaW5nIHRoZSBEQiBzbyByZXR1cm4gbm8gcmVzdWx0c1xyXG4gICAgICBmYXZvcml0ZXMuYWxsID0gIFtdO1xyXG4gICAgfSlcclxuICB9LFxyXG4gIHNob3dBc0Zhdm9yaXRlZDogZnVuY3Rpb24oKXsvL3Nob3dzIHRoZSBmYXZvcml0ZWQgYnV0dG9uXHJcbiAgICByZWNpcGUuZmF2b3JpdGVJY29uID0gXCIuLi9hc3NldHMvZmF2b3JpdGVkSWNvbi5wbmdcIjtcclxuICAgIHJlY2lwZS5mYXZvcml0ZUZ1bmN0aW9uID0gcmVjaXBlLnJlbW92ZVJlY2lwZTtcclxuICB9LFxyXG4gIHNob3dBc05vdEZhdm9yaXRlZDogZnVuY3Rpb24oKXsvL3Nob3dzIHRoZSBub3QgZmF2b3JpdGVkIGJ1dHRvblxyXG4gICAgcmVjaXBlLmZhdm9yaXRlSWNvbiA9IFwiLi4vYXNzZXRzL25vdEZhdm9yaXRlZEljb24ucG5nXCI7XHJcbiAgICByZWNpcGUuZmF2b3JpdGVGdW5jdGlvbiA9IHJlY2lwZS5zYXZlUmVjaXBlO1xyXG4gIH0sXHJcbiAgc2hvd0FzTG9hZGluZzogZnVuY3Rpb24oKXsvL3Nob3dzIHRoZSBsb2FkaW5nIGljb25cclxuICAgIHJlY2lwZS5mYXZvcml0ZUljb24gPSBcIi4uL2Fzc2V0cy9sb2FkaW5nLmdpZlwiO1xyXG4gICAgcmVjaXBlLmZhdm9yaXRlRnVuY3Rpb24gPSBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLy9kYXRhIGFuZCBmdW5jdGlvbnMgcmVsYXRlZCB0byB0aGUgdXNlciBpbnB1dCBjb250cm9sc1xyXG52YXIgdXNlcklucHV0cyA9IHtcclxuICBpbnRvbGVyYW5jZXM6IFtcIkRhaXJ5XCIsXCJFZ2dcIixcIkdsdXRlblwiLFwiR3JhaW5cIixcIlBlYW51dFwiLFwiU2VhZm9vZFwiXSxcclxuICB0eXBlczogW1xyXG4gICAge3RleHQ6IFwiTWFpblwiLCB2YWx1ZTogXCJtYWluIGNvdXJzZVwifSxcclxuICAgIHt0ZXh0OiBcIlNpZGUgRGlzaFwiLCB2YWx1ZTogXCJzaWRlIGRpc2hcIn0sXHJcbiAgICB7dGV4dDogXCJBcHBldGl6ZXJcIiwgdmFsdWU6IFwiYXBwZXRpemVyXCJ9LFxyXG4gICAge3RleHQ6IFwiU291cFwiLCB2YWx1ZTogXCJzb3VwXCJ9LFxyXG4gICAge3RleHQ6IFwiRGVzc2VydFwiLCB2YWx1ZTogXCJkZXNzZXJ0XCJ9LFxyXG4gICAge3RleHQ6IFwiU25hY2tcIiwgdmFsdWU6IFwic25hY2tcIn1cclxuICBdLFxyXG4gIG9uSW50b2xlcmFuY2VDbGljazogZnVuY3Rpb24oZSl7XHJcbiAgICBlLnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwic2VsZWN0ZWRcIik7XHJcbiAgfSxcclxuICBvblR5cGVzQ2xpY2s6IGZ1bmN0aW9uKGUpe1xyXG4gICAgdmFyIGFsbFJlY2lwZVR5cGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5pbnB1dEl0ZW0ucmVjaXBlVHlwZVwiKTtcclxuICAgIGFsbFJlY2lwZVR5cGVzLmZvckVhY2goKGl0ZW0sIGkpID0+IHtcclxuICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKFwic2VsZWN0ZWRcIik7XHJcbiAgICB9KTtcclxuICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoXCJzZWxlY3RlZFwiKTtcclxuICB9LFxyXG4gIG9uQmFja0J0bkNsaWNrOiBmdW5jdGlvbigpe1xyXG4gICAgVVJMLnJldm9rZU9iamVjdFVSTChyZWNpcGUuZGV0YWlscy5pbWFnZSk7XHJcbiAgICB3aW5kb3cubG9jYXRpb24gPSBcIiMhL21haW5cIjtcclxuICB9XHJcbn1cclxuXHJcbnZhciBsaWdodGJveCA9IHsvL2Nsb3NlcyB0aGUgZmF2b3JpdGUgcmVjaXBlIGxpZ2h0Ym94IHNlY3Rpb25cclxuICBjbG9zZTogZnVuY3Rpb24oKXtcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveFwiKVswXS5jbGFzc0xpc3QuYWRkKFwic2xpZGVPdXRcIik7Ly9zbGlkZSBvdXQgb2YgZnJhbWVcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveFwiKVswXS5jbGFzc0xpc3QucmVtb3ZlKFwic2xpZGVJblwiKTsvL3JlbW92ZSB0aGUgc2xpZGUgaW4gY2xhc3NcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveEJhY2tncm91bmRcIilbMF0uY2xhc3NMaXN0LmFkZChcImhpZGRlblwiKTsvL2hpZGUgdGhlIGxpZ2h0Ym94IGJhY2tncm91bmRcclxuICB9LFxyXG4gIG9wZW46IGZ1bmN0aW9uKCl7XHJcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKFwibGlnaHRib3hcIilbMF0uY2xhc3NMaXN0LnJlbW92ZShcInNsaWRlT3V0XCIpOy8vcmVtb3ZlIHRoZSBzbGlkZSBvdXQgY2xhc3NcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveFwiKVswXS5jbGFzc0xpc3QuYWRkKFwic2xpZGVJblwiKTsvL3NsaWRlIGludG8gZnJhbWVcclxuICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveEJhY2tncm91bmRcIilbMF0uY2xhc3NMaXN0LnJlbW92ZShcImhpZGRlblwiKTsvL3Nob3cgdGhlIGxpZ2h0Ym94IGJhY2tncm91bmRcclxuICB9XHJcbn1cclxuXHJcblxyXG5leHBvcnR7cmVjaXBlLGZhdm9yaXRlcyx1c2VySW5wdXRzLGxpZ2h0Ym94LGVycm9yVGhyb3dufTtcclxuIiwiLy9lbGVtZW50ID0+IHRoZSBodG1sIGVsZW1lbnQgdG8gYXR0YWNoIHRoZSBzd2lwZSBjb21tYW5kcyB0b1xyXG4vL3N3aXBlcyA9PiBvYmplY3QgY29udGFpbmluZyB0aGUgZnVuY3Rpb25zIHRvIHJ1biBvbiBsZWZ0LCByaWdodCwgdXAsIGFuZCBkb3duIHN3aXBlc1xyXG5jbGFzcyBTd2lwZXIge1xyXG4gIGNvbnN0cnVjdG9yKGVsZW1lbnQsIHN3aXBlcykge1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcclxuICAgIHRoaXMuc3dpcGVzID0gc3dpcGVzO1xyXG4gICAgdGhpcy5pbml0aWFsWCA9IG51bGw7XHJcbiAgICB0aGlzLmluaXRpYWxZID0gbnVsbDtcclxuICAgIHRoaXMuYXR0YWNoRXZlbnRIYW5kbGVycygpO1xyXG4gIH1cclxuICBhdHRhY2hFdmVudEhhbmRsZXJzKCl7Ly9hdHRhY2hlZCBldmVudCBoYW5kbGVyc1xyXG4gICAgLy9zd2lwZSBjb21tYW5kc1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIChldmVudCkgPT4gdGhpcy5zdGFydFRvdWNoKGV2ZW50KSk7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCAoZXZlbnQpID0+IHRoaXMubW92ZVRvdWNoKGV2ZW50LHRoaXMuc3dpcGVzKSk7XHJcblxyXG4gIH1cclxuICBzdGFydFRvdWNoKGUpIHtcclxuICAgIHRoaXMuaW5pdGlhbFggPSBlLnRvdWNoZXNbMF0uY2xpZW50WDtcclxuICAgIHRoaXMuaW5pdGlhbFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuICB9XHJcbiAgbW92ZVRvdWNoKGUsc3dpcGVzKSB7XHJcbiAgICBpZiAodGhpcy5pbml0aWFsWCA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAodGhpcy5pbml0aWFsWSA9PT0gbnVsbCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgdmFyIGN1cnJlbnRYID0gZS50b3VjaGVzWzBdLmNsaWVudFg7XHJcbiAgICB2YXIgY3VycmVudFkgPSBlLnRvdWNoZXNbMF0uY2xpZW50WTtcclxuICAgIHZhciBkaWZmWCA9IHRoaXMuaW5pdGlhbFggLSBjdXJyZW50WDtcclxuICAgIHZhciBkaWZmWSA9IHRoaXMuaW5pdGlhbFkgLSBjdXJyZW50WTtcclxuXHJcbiAgICBpZiAoTWF0aC5hYnMoZGlmZlgpID4gTWF0aC5hYnMoZGlmZlkpKSB7XHJcbiAgICAgIC8vIHNsaWRpbmcgaG9yaXpvbnRhbGx5XHJcbiAgICAgIGlmIChkaWZmWCA+IDAgJiYgc3dpcGVzLmxlZnQpIHtcclxuICAgICAgICAvLyBzd2lwZWQgbGVmdFxyXG4gICAgICAgIHN3aXBlcy5sZWZ0KCk7XHJcbiAgICAgIH0gZWxzZSBpZihzd2lwZXMucmlnaHQpIHtcclxuICAgICAgICAvLyBzd2lwZWQgcmlnaHRcclxuICAgICAgICBzd2lwZXMucmlnaHQoKTtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gc2xpZGluZyB2ZXJ0aWNhbGx5XHJcbiAgICAgIGlmIChkaWZmWSA+IDAgJiYgc3dpcGVzLnVwKSB7XHJcbiAgICAgICAgLy8gc3dpcGVkIHVwXHJcbiAgICAgICAgc3dpcGVzLnVwKCk7XHJcbiAgICAgIH0gZWxzZSBpZihzd2lwZXMuZG93bikge1xyXG4gICAgICAgIC8vIHN3aXBlZCBkb3duXHJcbiAgICAgICAgc3dpcGVzLmRvd24oKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuaW5pdGlhbFggPSBudWxsO1xyXG4gICAgdGhpcy5pbml0aWFsWSA9IG51bGw7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuZXhwb3J0e1N3aXBlcn07XHJcbiIsIi8qKioqKmFwcCB2aWV3cyoqKiovXHJcbmltcG9ydCB7cmVjaXBlLGZhdm9yaXRlcyx1c2VySW5wdXRzLGxpZ2h0Ym94LGVycm9yVGhyb3dufSBmcm9tICcuL2RhdGEuanMnO1xyXG5pbXBvcnQge1N3aXBlcn0gZnJvbSBcIi4vc3dpcGUuanNcIjtcclxuXHJcblxyXG4vKipDb21wZW5lbnRzKiovXHJcbnZhciBoZWFkZXIgPSB7Ly9oZWFkZXIgYmFyXHJcbiAgb25jcmVhdGU6ICgpPT57XHJcbiAgICB2YXIgc3dpcGVzID0ge2xlZnQ6IGxpZ2h0Ym94LmNsb3NlfVxyXG4gICAgdmFyIGxpZ2h0Ym94U3dpcGUgPSBuZXcgU3dpcGVyKGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJsaWdodGJveFwiKVswXSxzd2lwZXMpXHJcbiAgfSxcclxuICB2aWV3OiAoKT0+e1xyXG4gICAgcmV0dXJuIG0oXCIuaGVhZGVyXCIsW1xyXG4gICAgICBtKFwiLmxpZ2h0Ym94XCIsIFtcclxuICAgICAgICBtKFwiLmxpZ2h0Ym94SGVhZGVyXCIsIFwiU2F2ZWQgUmVjaXBlc1wiKSxcclxuICAgICAgICBmYXZvcml0ZXMuYWxsLm1hcCgoaXRlbSkgPT4gey8vZmF2b3JpdGVkIHJlY2lwZXMgbGlnaHRib3hcclxuICAgICAgICAgIHJldHVybiBtKFwiLnNhdmVkUmVjaXBlXCIse29uY2xpY2s6ICgpID0+e1xyXG4gICAgICAgICAgICByZWNpcGUuZ2V0UmVjaXBlKGl0ZW0uaWQpO1xyXG4gICAgICAgICAgfX0sW1xyXG4gICAgICAgICAgICBtKFwiLnNhdmVkUmVjaXBlVGl0bGVcIixpdGVtLnRpdGxlKSxcclxuICAgICAgICAgICAgbShcImltZy5mb3J3YXJkSW1hZ2VcIix7c3JjOiBcIi4uL2Fzc2V0cy9mb3J3YXJkLnBuZ1wifSlcclxuICAgICAgICAgIF1cclxuICAgICAgICApfSlcclxuICAgICAgXSksXHJcbiAgICAgIG0oXCIubGlnaHRib3hCYWNrZ3JvdW5kLmhpZGRlblwiLCB7b25jbGljazogbGlnaHRib3guY2xvc2V9KSxcclxuICAgICAgbShcImltZy5zYXZlZE5hdkljb25cIix7c3JjOiBcIi4uL2Fzc2V0cy9zYXZlZE5hdkljb24ucG5nXCIsIG9uY2xpY2s6IGZhdm9yaXRlcy5nZXRBbGx9KSxcclxuICAgICAgbShcIi5jZW50ZXJUZXh0XCIsIFwiUmVjaXBlIEFwcFwiKVxyXG4gICAgXSlcclxuICB9XHJcbn1cclxuXHJcbnZhciBoZWFkZXJCYWNrQnRuID0gey8vaGVhZGVyIGJhclxyXG4gIHZpZXc6ICgpPT57XHJcbiAgICByZXR1cm4gbShcIi5oZWFkZXJcIixbXHJcbiAgICAgICAgbShcImltZy5iYWNrQnRuXCIsIHthbHQ6IFwibmF2aWdhdGUgYmFja1wiLHNyYzogXCIuLi9hc3NldHMvYmFjay5wbmdcIiwgb25jbGljazogdXNlcklucHV0cy5vbkJhY2tCdG5DbGlja30pLFxyXG4gICAgICBtKFwiLmNlbnRlclRleHRcIiwgXCJSZWNpcGUgQXBwXCIpXHJcbiAgICBdKVxyXG4gIH1cclxufVxyXG5cclxudmFyIGhvbWVTY3JlZW4gPSB7Ly9ob21lIHNjcmVlblxyXG4gIHZpZXc6ICgpPT57XHJcbiAgICByZXR1cm4gbShcImhvbWVTY3JlZW4uY29udGVudFZpZXdcIixbXHJcbiAgICAgIG0oaGVhZGVyKSxcclxuICAgICAgbShcIi5wYWdlQ29udGVudFwiLFtcclxuICAgICAgICBtKFwiLnBhZ2VTZWN0aW9uXCIsIFtcclxuICAgICAgICAgIG0oXCIuc2VjdGlvbkhlYWRlclwiLFwiUmVjaXBlIHR5cGVcIiksXHJcbiAgICAgICAgICBtKFwiLmlucHV0TGlzdFwiLHVzZXJJbnB1dHMudHlwZXMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICByZXR1cm4gbShcIi5idG4uaW5wdXRJdGVtLnJlY2lwZVR5cGVcIix7b25jbGljazogKGUpPT57dXNlcklucHV0cy5vblR5cGVzQ2xpY2soZSl9LCBkYXRhOiBpdGVtLnZhbHVlfSxpdGVtLnRleHQpXHJcbiAgICAgICAgICB9KSlcclxuICAgICAgICBdKSxcclxuICAgICAgICBtKFwiLnBhZ2VTZWN0aW9uXCIsIFtcclxuICAgICAgICAgIG0oXCIuc2VjdGlvbkhlYWRlclwiLFwiSW50b2xlcmFuY2VzXCIpLFxyXG4gICAgICAgICAgbShcIi5pbnB1dExpc3RcIix1c2VySW5wdXRzLmludG9sZXJhbmNlcy5tYXAoKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgIHJldHVybiBtKFwiLmJ0bi5pbnB1dEl0ZW0uaW50b2xlcmFuY2VcIix7b25jbGljazogKGUpPT57dXNlcklucHV0cy5vbkludG9sZXJhbmNlQ2xpY2soZSl9fSxpdGVtKVxyXG4gICAgICAgICAgfSkpXHJcbiAgICAgICAgXSksXHJcbiAgICAgICAgbShcIi5wYWdlU2VjdGlvbi5zd2l0Y2hTZWN0aW9uXCIsIFtcclxuICAgICAgICAgIG0oXCIuc2VjdGlvbkhlYWRlclwiLCBcIjMwIG1pbnV0ZXMgb3IgbGVzc1wiKSxcclxuICAgICAgICAgIG0oXCJsYWJlbC5zd2l0Y2hcIixbXHJcbiAgICAgICAgICAgIG0oXCJpbnB1dFwiLCB7dHlwZTogXCJjaGVja2JveFwifSksXHJcbiAgICAgICAgICAgIG0oXCJkaXYuc2xpZGVyXCIpXHJcbiAgICAgICAgICBdKVxyXG4gICAgICAgIF0pLFxyXG4gICAgICAgIG0oXCIucmVjaXBlU2VhcmNoLmJ0blwiLHtvbmNsaWNrOiByZWNpcGUuc2VhcmNofSAgLFwiU2VhcmNoIGZvciByZWNpcGVcIilcclxuICAgICAgXSlcclxuICAgIF0pXHJcbiAgfVxyXG59XHJcblxyXG52YXIgb2ZmbGluZVNjcmVlbiA9IHsvL2hvbWUgc2NyZWVuIHdoZW4gb2ZmbGluZVxyXG4gIHZpZXc6ICgpPT57XHJcbiAgICByZXR1cm4gbShcIm9mZmxpbmVTY3JlZW4uY29udGVudFZpZXdcIixbXHJcbiAgICAgIG0oaGVhZGVyKSxcclxuICAgICAgbShcIi5wYWdlQ29udGVudFwiLFtcclxuICAgICAgICBtKFwiLnBhZ2VTZWN0aW9uXCIsIFtcclxuICAgICAgICAgIG0oXCIuc2VjdGlvbkhlYWRlclwiLFwiWW91IGFyZSBvZmZsaW5lLiBTYXZlZCByZWNpcGVzIGNhbiBiZSB2aWV3ZWQgYnV0IG5ldyBvbmVzIGNhbm5vdCBiZSBmb3VuZCB1bnRpbCB5b3UgY29ubmVjdCB0byB0aGUgaW50ZXJuZXQuXCIpLFxyXG4gICAgICAgIF0pXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIH1cclxufVxyXG5cclxudmFyIHJlY2lwZVNjcmVlbiA9IHsvL3NlbGVjdGVkIHJlY2lwZSBzY3JlZW5cclxuICB2aWV3OiAoKT0+e1xyXG4gICAgcmV0dXJuIG0oXCJyZWNpcGVTY3JlZW4uY29udGVudFZpZXdcIixbXHJcbiAgICAgIG0oaGVhZGVyQmFja0J0biksXHJcbiAgICAgIG0oXCIucGFnZUNvbnRlbnRcIixbXHJcbiAgICAgICAgbShcIi5oZXJvU2VjdGlvblwiLFtcclxuICAgICAgICAgIG0oXCJpbWcuaGVyb0ltYWdlLmZhZGVJblwiLCB7c3JjOiByZWNpcGUuZGV0YWlscy5pbWFnZSwgYWx0OiBcImltYWdlXCJ9KVxyXG4gICAgICAgIF0pLFxyXG4gICAgICAgIG0oXCIucGFnZVNlY3Rpb24uZmF2b3JpdGVTZWN0aW9uLmZhZGVJblwiLCBbXHJcbiAgICAgICAgICBtKFwiLmZhdm9yaXRlVGl0bGVcIixyZWNpcGUuZGV0YWlscy50aXRsZSksXHJcbiAgICAgICAgICBtKFwiaW1nLmZhdm9yaXRlSW1hZ2VcIix7c3JjOiByZWNpcGUuZmF2b3JpdGVJY29uLCBvbmNsaWNrOiByZWNpcGUuZmF2b3JpdGVGdW5jdGlvbn0pXHJcbiAgICAgICAgICAvL29uaW5pdDogKHZub2RlKSA9PiB7aWYgKCEoJ2luZGV4ZWREQicgaW4gd2luZG93KSkge3Zub2RlLmF0dHJzLmNsYXNzTmFtZSA9IFwic2F2ZWQgaGlkZGVuXCI7fX1cclxuICAgICAgICBdKSxcclxuICAgICAgICBtKFwiLnBhZ2VTZWN0aW9uLmZhZGVJblwiLCBbXHJcbiAgICAgICAgICBtKFwiLmxpc3RUaXRsZVwiLFwiSW5ncmVkaWVudHNcIiksXHJcbiAgICAgICAgICBtKFwiLmluZ3JlZGllbnRMaXN0XCIscmVjaXBlLmRldGFpbHMuaW5ncmVkaWVudHMubWFwKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICByZXR1cm4gbShcIi5pbmdyZWRpZW50XCIsaXRlbSlcclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgIF0pLFxyXG4gICAgICAgIG0oXCIucGFnZVNlY3Rpb24uZmFkZUluXCIsIFtcclxuICAgICAgICAgIG0oXCIubGlzdFRpdGxlXCIsXCJDb29raW5nIGRpcmVjdGlvbnNcIiksXHJcbiAgICAgICAgICBtKFwiLmRpcmVjdGlvbkxpc3RcIixyZWNpcGUuZGV0YWlscy5kaXJlY3Rpb25zLm1hcCgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgcmV0dXJuIG0oXCIuZGlyZWN0aW9uXCIsaXRlbSlcclxuICAgICAgICAgIH0pKVxyXG4gICAgICAgIF0pXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIH1cclxufVxyXG5cclxudmFyIGxvYWRTY3JlZW4gPXsvL3NjcmVlbiB0byBzaG93IHdoaWxlIHJlcXVlc3RzIGFyZSBsb2FkZWRcclxuICBvbmNyZWF0ZTogKCk9PntcclxuICAgIGhpc3RvcnkucmVwbGFjZVN0YXRlKG51bGwsIFwiaG9tZVwiLCBcIiMhL2hvbWVcIik7Ly91cGRhdGUgYnJvd2VycyBoaXN0b3J5IHRvIHNraXAgdGhlIGxvYWRpbmcgc2NyZWVuIGlmIHRoZSBiYWNrIGJ1dHRvbiBpcyB1c2VkXHJcbiAgfSxcclxuICB2aWV3OiAoKSA9PntcclxuICAgIHJldHVybiBtKFwibG9hZGluZ1NjcmVlbi5jb250ZW50Vmlld1wiLFtcclxuICAgICAgbShcIi5wYWdlQ29udGVudFwiLFtcclxuICAgICAgICBtKFwiaW1nLmxvYWRpbmdJbWFnZVwiLHtzcmM6XCIuLi9hc3NldHMvbG9hZGluZy5naWZcIn0pXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIH1cclxufVxyXG5cclxudmFyIGVycm9yU2NyZWVuID0gey8vc2NyZWVuIHNob3dpbmcgZXJyb3JzXHJcbiAgb25jcmVhdGU6ICgpPT57XHJcbiAgICBoaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBcImhvbWVcIiwgXCIjIS9ob21lXCIpOy8vdXBkYXRlIGJyb3dlcnMgaGlzdG9yeSB0byBza2lwIHRoZSBsb2FkaW5nIHNjcmVlbiBpZiB0aGUgYmFjayBidXR0b24gaXMgdXNlZFxyXG4gIH0sXHJcbiAgdmlldzogKCkgPT57XHJcbiAgICByZXR1cm4gbShcImVycm9yU2NyZWVuLmNvbnRlbnRWaWV3XCIsW1xyXG4gICAgICBtKGhlYWRlckJhY2tCdG4pLFxyXG4gICAgICBtKFwiLnBhZ2VDb250ZW50XCIsW1xyXG4gICAgICAgIG0oXCIuZXJyb3JTY3JlZW5UZXh0XCIsZXJyb3JUaHJvd24pXHJcbiAgICAgIF0pXHJcbiAgICBdKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0e2hvbWVTY3JlZW4sbG9hZFNjcmVlbixlcnJvclNjcmVlbixyZWNpcGVTY3JlZW4sb2ZmbGluZVNjcmVlbn07XHJcbiIsImltcG9ydCB7b2ZmbGluZVNjcmVlbixsb2FkU2NyZWVuLGVycm9yU2NyZWVuLHJlY2lwZVNjcmVlbn0gZnJvbSAnLi92aWV3cy5qcyc7XHJcblxyXG53aW5kb3cub25sb2FkID0gKCkgPT57XHJcbiAgLy9zZXQgdXAgdGhlIHNlcnZpY2Ugd29ya2VyIG9uY2UgdGhlIHBhZ2UgbG9hZHNcclxuICAvL2lmICgnc2VydmljZVdvcmtlcicgaW4gbmF2aWdhdG9yKSB7bmF2aWdhdG9yLnNlcnZpY2VXb3JrZXIucmVnaXN0ZXIoJ3NlcnZpY2Utd29ya2VyLmpzJyk7fVxyXG5cclxuICB3aW5kb3cubG9jYXRpb24gPSBcIiMhL29mZmxpbmVcIjsvL3N0YXJ0IHRoZSBhcHAgb24gdGhlIG1haW4gc2NyZWVuXHJcblxyXG4gIHZhciByb290ID0gZG9jdW1lbnQuYm9keS5jaGlsZHJlblswXTtcclxuXHJcblxyXG4gIG0ucm91dGUocm9vdCwgXCIvb2ZmbGluZVwiLHtcclxuICAgIFwiL29mZmxpbmVcIjogb2ZmbGluZVNjcmVlbixcclxuICAgIFwiL2xvYWRcIjogbG9hZFNjcmVlbixcclxuICAgIFwiL2Vycm9yXCI6IGVycm9yU2NyZWVuLFxyXG4gICAgXCIvcmVjaXBlXCI6IHJlY2lwZVNjcmVlbixcclxuICB9KVxyXG5cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9